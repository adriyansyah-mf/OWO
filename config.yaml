# Open Workstation Observer (OWO). Path: -config config.yaml or default.

agent:
  name: ""        # default: hostname
  hostname: ""    # default: os.Hostname()
  group: ""       # optional, e.g. "servers"

monitor:
  execve: true         # process execution (eBPF)
  ebpf_path: ""        # default: auto (bpf/execve.o)
  file_events: true    # openat, unlink, rename
  file_watch_all_paths: true  # true = all paths (noisier); false = only /etc,/usr/bin,/bin,/tmp,/dev/shm
  network_events: true   # connect, sendto, accept (inbound); DNS = port 53
  privilege_events: true # setuid, setgid, setreuid, setregid
  exit_events: true      # process exit (exit_group)
  write_events: false    # write syscall (noisy; path from /proc/pid/fd)
  module_events: true    # kernel module load (init_module, finit_module)
  process_events: true  # fork, clone, clone3 (syscall level; noisy)
  gtfobins_path: "contrib/gtfobins.json"    # optional: path to local gtfobins api.json (run contrib/scripts/fetch_gtfobins.sh first)

output:
  file:
    enabled: true   # write events to path; /var/log/edr is created at startup
    path: "/var/log/edr/alerts.jsonl"
  stderr: true    # print alerts to stderr
  remote:
    enabled: false
    address: ""   # manager host:port, e.g. "192.168.1.10:1514"
    protocol: tcp # tcp | tls | http | https
    http_endpoint: "/alerts"
    max_retries: 5
    retry_interval: 10

logging:
  level: warn   # debug | info | warn | error; controls which messages are printed to stderr
