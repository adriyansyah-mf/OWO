# EDR Client (OWO). Use -config config.yaml or config.production.yaml
#
# Production: use config.production.yaml (lower event volume, no console spam)
# Dev/Debug: this file (or set file_watch_all_paths/process_events true for more events)

agent:
  name: ""
  hostname: ""
  group: ""

output:
  file:
    enabled: true
    path: "/var/log/edr/events.jsonl"
  stderr: false    # true = print events to console (dev only)
  nats:
    enabled: true
    url: "nats://127.0.0.1:4222"
    subject: "events.default"
    tenant_id: "default"
  remote:
    enabled: false
    address: ""
    protocol: tcp
    http_endpoint: "/alerts"
    max_retries: 5
    retry_interval: 10

monitor:
  process_snapshot_interval: 60   # periodic ps aux (no per-execve storage)
  execve: true
  sigma_rules_path: "sigma/rules"   # hanya execve yg match Sigma rules tampil di stdout
  clamav_scan_paths: ["/tmp", "/var/tmp", "/home"]   # path untuk AV scan
  realtime_av_scan: false   # true = scan executable on every execve (real-time malware detection)
  dlp_scan_paths: ["/tmp", "/var/tmp", "/home"]     # path untuk DLP scan
  ebpf_path: ""
  file_events: true
  file_watch_all_paths: false
  network_events: true
  privilege_events: true
  exit_events: true
  write_events: false   # set true for Device Control (USB copy monitoring)
  module_events: true
  process_events: false
  gtfobins_path: "contrib/gtfobins.json"

logging:
  level: warn
